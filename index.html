<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<title>Lịch Giúp Lễ</title>
<style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #555; padding: 8px; text-align: center; }
    select { width: 150px; margin: 3px 0; }
    button { padding: 10px 16px; margin-top: 20px; font-size: 16px; cursor: pointer; }
</style>
</head>
<!-- Thanh Điều Khiển -->
<nav style="
    width: 100%;
    background: #2b63c6;
    padding: 12px 0;
    display: flex;
    justify-content: center;
    gap: 40px;
    font-family: Arial, sans-serif;
">
    <a href="index.html" style="color: white; font-size: 18px; text-decoration: none;">Trang Chủ</a>
    <a href="1.html" style="color: white; font-size: 18px; text-decoration: none;">bản thử nghiệm</a>
    <a href="danhsach.html" style="color: white; font-size: 18px; text-decoration: none;">Danh Sách Thành Viên</a>
</nav>

<body>

<h2>Bảng Chia Lịch Giúp Lễ</h2>

<table>
    <tr>
        <th>Thứ</th>
        <th>Buổi</th>
        <th>Phân Công</th>
    </tr>

    <tr><td>Thứ Hai</td><td>Tối</td><td class="cell" data-id="mon_c"></td></tr>
    <tr><td>Thứ Ba</td><td>Tối</td><td class="cell" data-id="tue_c"></td></tr>
    <tr><td>Thứ Tư</td><td>Tối</td><td class="cell" data-id="wed_c"></td></tr>
    <tr><td>Thứ Năm</td><td>Tối</td><td class="cell" data-id="thu_c"></td></tr>
    <tr><td>Thứ Sáu</td><td>Tối</td><td class="cell" data-id="fri_c"></td></tr>

    <tr><td rowspan="2">Thứ Bảy</td><td>Sáng</td><td class="cell" data-id="sat_s"></td></tr>
    <tr><td>Tối</td><td class="cell" data-id="sat_c"></td></tr>

    <tr><td rowspan="2">Chủ Nhật</td><td>Sáng</td><td class="cell" data-id="sun_s"></td></tr>
    <tr><td>Tối</td><td class="cell" data-id="sun_c"></td></tr>
</table>

<button onclick="downloadWord()">Tải Lịch Xuống File Word</button>

<script>
const names = [
    "Vỹ","Thắng","Vy","Thư","Thương","N.Minh","K.Bình","N.Anh",
    "V.Minh","Quân","Lan","Thảo","Long","H.Anh","Ánh (bé)","Bích",
    "Phong","Phúc","Linh (bé)","Ngà","Trãi","Ánh (lớn)",
    "Nhi","Dũng","Cương","Sấy","Triệu"
];

function makeSelect() {
    let html = "<select>";
    html += `<option value="">---</option>`;
    names.forEach(n => html += `<option>${n}</option>`);
    html += "</select>";
    return html;
}

document.querySelectorAll(".cell").forEach(cell => {
    let id = cell.dataset.id;
    let count = 4;
    if (id === "sat_s" || id === "sun_s") count = 2;
    for (let i = 1; i <= count; i++) {
        cell.innerHTML += makeSelect() + "<br>";
    }
});

function downloadWord() {
    let content = "<h2>Lịch Giúp Lễ</h2><table border='1' cellspacing='0' cellpadding='6'>";
    document.querySelectorAll("table tr").forEach(tr => {
        content += "<tr>";
        tr.querySelectorAll("td,th").forEach(cell => {
            if (cell.classList.contains("cell")) {
                let selects = [...cell.querySelectorAll("select")].map(s => s.value || "—").join(" – ");
                content += `<td>${selects}</td>`;
            } else {
                content += `<td>${cell.innerText}</td>`;
            }
        });
        content += "</tr>";
    });
    content += "</table>";
    let blob = new Blob(['\ufeff', content], { type: 'application/msword' });
    let url = URL.createObjectURL(blob);
    let a = document.createElement("a");
    a.href = url;
    a.download = "lich_giup_le.doc";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}
</script>

</body>

</html>
